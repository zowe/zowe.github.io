<!-- Used to write out HTML specifying how to run GPG signing against downloaded binaries -->
<script>
    main = () => {
        params = new URLSearchParams(location.search);
    
        if (!params.has('version') || !params.has('type')) {
            // error condition
            document.getElementById('main-content').innerHTML = 
            '<h1 class="title" id="page_title">There was an error finding your download.</h1>' +
                '<br /><p> Please visit the <a href="/download">Zowe Download Site</a> and try again.</p>';
            return;
        }
        const rtBaseUrl = 'https://zowe.jfrog.io/zowe/list/libs-release-local/org/zowe'
        const artifactDetails = getArtifactInfo(params);
        const artifact = artifactDetails['artifact'];
        const componentName = artifactDetails['componentName']
        const version = params.get('version');

        if(version.toString().startsWith('1')) {
            document.getElementById('end-of-support-reminder').style.display = "block";
        }

        document.getElementById('download_link').href = `legal.html?type=${params.get('type')}&version=${version}`;
        document.getElementById('page_title').innerText = 'Thank you for downloading the ' + componentName;
        document.getElementById('download_bundle_step').innerHTML = `2. Download <a href="${rtBaseUrl}/${version}/${artifact}.bundle" download 
                 target="_blank"  onclick="gs && ga('send', 'event', 'download', '${componentName} bundle', '${artifact}.bundle');">the ${componentName} signing bundle.</a>`;
      
        document.getElementById('cosign_verify_online').innerHTML = 
            `cosign verify ./${artifact} --bundle ./${artifact}.bundle 
                --certificate-identity=https://github.com/zowe/zowe-install-packaging/.github/workflows/build-packaging.yml@refs/heads/v${version.toString()[0]}.x/master 
                --certificate-oidc-issuer=https://token.actions.githubusercontent.com`; 


        document.getElementById('cosign_verify_offline').innerHTML = 
            `cosign verify ./${artifact} --bundle ./${artifact}.bundle --offline 
                --certificate-identity=https://github.com/zowe/zowe-install-packaging/.github/workflows/build-packaging.yml@refs/heads/v${version.toString()[0]}.x/master 
                --certificate-oidc-issuer=https://token.actions.githubusercontent.com`; 
    }
   
    main() 
</script>